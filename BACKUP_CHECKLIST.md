# ğŸ“‹ å®‡ç¡•å¤ç›˜å›¾é‰´ - å¤‡ä»½æ£€æŸ¥æ¸…å•

## å¤‡ä»½æ—¶é—´ï¼š2025å¹´9æœˆ5æ—¥

### âœ… å·²å®Œæˆçš„å¤‡ä»½ï¼š
- [x] **ä»£ç å¤‡ä»½**: `../backups/å®‡ç¡•å¤ç›˜å›¾é‰´_ç¨³å®šç‰ˆ_2025_09_05.tar.gz`
- [x] **æ•°æ®åº“ç»“æ„å¤‡ä»½**: `log/database_backup_2025_09_05.sql`
- [x] **å®Œæ•´æ•°æ®å¤‡ä»½**: `log/database_data_backup_2025_09_05.sql`
  - 4ä¸ªç”¨æˆ·: test3, test4, å®‡ç¡•, admin
  - 2æ¡æƒé™è®°å½•: test3å’Œå®‡ç¡•å„æœ‰1ä¸ªæœˆæƒé™
- [ ] **é…ç½®æ–‡ä»¶å¤‡ä»½**: éœ€è¦ä¿å­˜.env.localæ–‡ä»¶
- [ ] **Supabaseä¿¡æ¯è®°å½•**: éœ€è¦è®°å½•é¡¹ç›®URLå’Œå¯†é’¥

### ğŸ“¥ éœ€è¦æ‰‹åŠ¨å®Œæˆçš„å¤‡ä»½ï¼š

#### 1. æ•°æ®åº“æ•°æ®å¯¼å‡º
1. ç™»å½•Supabase Dashboard â†’ SQL Editor
2. è¿è¡Œæ•°æ®å¯¼å‡ºSQLï¼ˆè§ä¸‹é¢ï¼‰
3. ä¿å­˜ç»“æœä¸º `database_data_backup_2025_09_05.sql`

```sql
-- æ•°æ®å¯¼å‡ºSQL
SELECT 
    'INSERT INTO public.profiles (id, wechat_nickname, is_admin, created_at) VALUES ' ||
    string_agg(
        '(''' || id || ''', ''' || wechat_nickname || ''', ' || is_admin || ', ''' || created_at || ''')',
        ', '
    ) || ';'
FROM public.profiles;

SELECT 
    'INSERT INTO public.access_grants (id, user_id, granted_by, granted_at, expires_at, duration_key) VALUES ' ||
    string_agg(
        '(''' || id || ''', ''' || user_id || ''', ' || 
        COALESCE('''' || granted_by || '''', 'NULL') || ', ''' || 
        granted_at || ''', ' || 
        COALESCE('''' || expires_at || '''', 'NULL') || ', ''' || 
        duration_key || ''')',
        ', '
    ) || ';'
FROM public.access_grants;
```

#### 2. é…ç½®ä¿¡æ¯å¤‡ä»½
åˆ›å»ºæ–‡ä»¶ `supabase_config_backup.txt`:
```
é¡¹ç›®URL: [ä»Supabase Dashboardå¤åˆ¶]
Anon Key: [ä»Supabase Dashboardå¤åˆ¶]
Service Key: [ä»Supabase Dashboardå¤åˆ¶]
ç®¡ç†å‘˜è´¦å·: admin@yushuo.local
ç®¡ç†å‘˜å¯†ç : 7287843
é‚®ç®±åŸŸå: wx.local
```

### ğŸ“¦ å®Œæ•´å¤‡ä»½åŒ…åº”åŒ…å«ï¼š
1. `å®‡ç¡•å¤ç›˜å›¾é‰´_ç¨³å®šç‰ˆ_2025_09_05.tar.gz` (ä»£ç )
2. `database_backup_2025_09_05.sql` (è¡¨ç»“æ„ï¼Œå·²æœ‰)
3. `database_data_backup_2025_09_05.sql` (æ•°æ®)
4. `supabase_config_backup.txt` (é…ç½®)
5. `.env.local` (ç¯å¢ƒå˜é‡)

### ğŸ”„ å¤‡ä»½éªŒè¯æ­¥éª¤ï¼š
- [ ] ä»£ç æ–‡ä»¶å®Œæ•´ (æ£€æŸ¥tar.gzå†…å®¹)
- [ ] æ•°æ®åº“ç»“æ„SQLå¯æ‰§è¡Œ
- [ ] æ•°æ®å¯¼å‡ºSQLæ— é”™è¯¯
- [ ] é…ç½®ä¿¡æ¯å‡†ç¡®è®°å½•
- [ ] ç®¡ç†å‘˜ç™»å½•æ­£å¸¸

## ğŸš€ æ¢å¤æ—¶çš„ä½¿ç”¨æ–¹æ³•ï¼š

### å¿«é€Ÿæ¢å¤æ­¥éª¤ï¼š
1. **è§£å‹ä»£ç **: è§£å‹ `å®‡ç¡•å¤ç›˜å›¾é‰´_ç¨³å®šç‰ˆ_2025_09_05.tar.gz`
2. **å®‰è£…ä¾èµ–**: `npm install`
3. **åˆ›å»ºSupabaseé¡¹ç›®**: ä½¿ç”¨é…ç½®ä¿¡æ¯
4. **æ¢å¤æ•°æ®åº“**: 
   - æ‰§è¡Œ `database_backup_2025_09_05.sql` (è¡¨ç»“æ„)
   - æ‰§è¡Œ `database_data_backup_2025_09_05.sql` (æ•°æ®)
5. **é…ç½®ç¯å¢ƒ**: å¤åˆ¶å¹¶æ›´æ–° `.env.local`
6. **å¯åŠ¨æµ‹è¯•**: `npm run dev`

### éªŒè¯æ¢å¤æˆåŠŸï¼š
- [ ] ç½‘ç«™æ­£å¸¸è®¿é—® http://localhost:5173
- [ ] ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½æ­£å¸¸
- [ ] æ˜µç§°ç™»å½•åŠŸèƒ½æ­£å¸¸
- [ ] ç®¡ç†å‘˜ç™»å½•æ­£å¸¸ (admin/7287843)
- [ ] æƒé™æ§åˆ¶æ­£å¸¸å·¥ä½œ
- [ ] ç”¨æˆ·ä¸»é¡µæ­£å¸¸æ˜¾ç¤º

**æ¢å¤æ—¶é—´é¢„è®¡ï¼š5-10åˆ†é’Ÿ** â±ï¸

## ğŸ’¡ é‡è¦æé†’ï¼š
- å°†å®Œæ•´å¤‡ä»½åŒ…ä¿å­˜åœ¨å¤šä¸ªä½ç½®ï¼ˆæœ¬åœ°+äº‘ç›˜ï¼‰
- å®šæœŸæµ‹è¯•å¤‡ä»½æ¢å¤æµç¨‹
- è®°å½•æ¯æ¬¡å¤‡ä»½çš„åŠŸèƒ½çŠ¶æ€
- ä¿æŠ¤Supabaseå¯†é’¥å®‰å…¨

**å½“å‰ç³»ç»ŸçŠ¶æ€ï¼šç”Ÿäº§å°±ç»ªï¼ŒåŠŸèƒ½å®Œæ•´ âœ…**