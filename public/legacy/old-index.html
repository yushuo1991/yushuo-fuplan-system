<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¶¨åœæ¿å—æº¢ä»·åˆ†æç³»ç»Ÿ</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="footer-styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
    <script>
        // ğŸš€ è‡ªåŠ¨é‡å®šå‘åˆ°å¢å¼ºç‰ˆé¡µé¢ï¼ˆä½¿ç”¨çœŸå®APIï¼‰
        if (window.location.pathname === '/' || window.location.pathname === '/index.html') {
            console.log('ğŸ”„ è‡ªåŠ¨é‡å®šå‘åˆ°å¢å¼ºç‰ˆé¡µé¢ï¼ˆçœŸå®APIç‰ˆæœ¬ï¼‰');
            window.location.href = '/enhanced.html';
        }
        
        // Chart.jsåŠ è½½æ£€æŸ¥å’Œåå¤‡æ–¹æ¡ˆ
        document.addEventListener('DOMContentLoaded', function() {
            function checkAndLoadFallback() {
                if (typeof Chart === 'undefined') {
                    console.warn('Chart.js CDNåŠ è½½å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°ç®€å•å›¾è¡¨åº“');
                    // åŠ è½½æœ¬åœ°ç®€å•å›¾è¡¨åº“
                    const script = document.createElement('script');
                    script.src = 'simple-chart.js';
                    script.onload = function() {
                        console.log('æœ¬åœ°ç®€å•å›¾è¡¨åº“åŠ è½½æˆåŠŸ');
                    };
                    script.onerror = function() {
                        console.error('æœ¬åœ°å›¾è¡¨åº“ä¹ŸåŠ è½½å¤±è´¥ï¼Œå›¾è¡¨åŠŸèƒ½å°†è¢«ç¦ç”¨');
                    };
                    document.head.appendChild(script);
                } else {
                    console.log('Chart.js åŠ è½½æˆåŠŸ');
                }
            }
            
            // ç«‹å³æ£€æŸ¥
            checkAndLoadFallback();
            
            // å»¶è¿Ÿå†æ¬¡æ£€æŸ¥ï¼ˆç»™CDNæ›´å¤šæ—¶é—´ï¼‰
            setTimeout(checkAndLoadFallback, 1000);
        });
    </script>
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <header class="header">
            <div class="header-content">
                <h1 class="title">
                    <i class="fas fa-chart-line"></i>
                    æ¶¨åœæ¿å—æº¢ä»·åˆ†æ
                </h1>
                <p class="subtitle">å®æ—¶è·Ÿè¸ªæ¶¨åœè‚¡ç¥¨æ¿å—è¡¨ç°ä¸åç»­æ¶¨è·Œ</p>
            </div>
        </header>

        <!-- æ§åˆ¶é¢æ¿ -->
        <section class="control-panel">
            <div class="control-group">
                <label for="dateSelect" class="control-label">
                    <i class="fas fa-calendar-alt"></i>
                    é€‰æ‹©æ—¥æœŸ
                </label>
                <input type="date" id="dateSelect" class="date-input">
                <button id="refreshBtn" class="refresh-btn">
                    <i class="fas fa-sync-alt"></i>
                    åˆ·æ–°æ•°æ®
                </button>
            </div>
            <div class="status-bar">
                <div id="statusText" class="status-text">å‡†å¤‡å°±ç»ª</div>
                <div id="loadingSpinner" class="loading-spinner" style="display: none;">
                    <i class="fas fa-spinner fa-spin"></i>
                </div>
            </div>
        </section>

        <!-- æ•°æ®ç»Ÿè®¡æ¦‚è§ˆ -->
        <section class="stats-overview" id="statsOverview" style="display: none;">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-arrow-up"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalLimitUp">0</div>
                        <div class="stat-label">æ¶¨åœè‚¡ç¥¨</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-layer-group"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalCategories">0</div>
                        <div class="stat-label">æ¿å—æ•°é‡</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="topCategory">-</div>
                        <div class="stat-label">æœ€å¤§æ¿å—</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="avgReturn">0%</div>
                        <div class="stat-label">å¹³å‡æ¶¨å¹…</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- æ¿å—åˆ†å¸ƒå›¾è¡¨ -->
        <section class="chart-section" id="chartSection" style="display: none;">
            <h2 class="section-title">
                <i class="fas fa-chart-pie"></i>
                æ¿å—åˆ†å¸ƒåˆ†æ
            </h2>
            <div class="chart-container">
                <canvas id="categoryChart"></canvas>
            </div>
        </section>

        <!-- æ¿å—è¯¦æƒ…åˆ—è¡¨ -->
        <section class="categories-section" id="categoriesSection" style="display: none;">
            <h2 class="section-title">
                <i class="fas fa-list"></i>
                æ¿å—è¯¦æƒ…åˆ†æ
            </h2>
            
            <!-- è§†å›¾åˆ‡æ¢æ§åˆ¶ -->
            <div class="view-controls">
                <label>æ˜¾ç¤ºæ–¹å¼:</label>
                <div class="view-toggle">
                    <button id="tableViewBtn" class="active" onclick="switchView('table')">
                        <i class="fas fa-table"></i> è¡¨æ ¼è§†å›¾
                    </button>
                    <button id="gridViewBtn" onclick="switchView('grid')">
                        <i class="fas fa-th-large"></i> å¡ç‰‡è§†å›¾
                    </button>
                </div>
            </div>
            
            <div id="categoriesList" class="categories-list">
                <!-- åŠ¨æ€ç”Ÿæˆæ¿å—å†…å®¹ -->
            </div>
        </section>

        <!-- æ— æ•°æ®æç¤º -->
        <section class="no-data" id="noDataSection" style="display: none;">
            <div class="no-data-content">
                <i class="fas fa-exclamation-circle"></i>
                <h3>æš‚æ— æ•°æ®</h3>
                <p>è¯·é€‰æ‹©å…¶ä»–äº¤æ˜“æ—¥æœŸæˆ–ç¨åå†è¯•</p>
            </div>
        </section>

        <!-- é¡µè„š -->
        <footer class="footer">
            <div class="footer-content">
                <p>&copy; 2024 æ¶¨åœæ¿å—æº¢ä»·åˆ†æç³»ç»Ÿ | æ•°æ®æ¥æº: Tushare</p>
                <div class="footer-links">
                    <span>æœ€åæ›´æ–°: <span id="lastUpdate">-</span></span>
                </div>
            </div>
        </footer>
    </div>

    <!-- æ¨¡æ€æ¡† - è‚¡ç¥¨è¯¦æƒ… -->
    <div id="stockModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">è‚¡ç¥¨è¯¦æƒ…</h3>
                <button class="close-btn" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="modalContent">
                    <!-- åŠ¨æ€ç”Ÿæˆè¯¦æƒ…å†…å®¹ -->
                </div>
            </div>
        </div>
    </div>

    <!-- æ•°æ®æ¥æºä¿¡æ¯ -->
    <footer class="data-source-footer">
        <div class="footer-content">
            <div class="data-info">
                <h4>ğŸ“Š æ•°æ®æ¥æºä¿¡æ¯</h4>
                <div class="source-details">
                    <div class="source-item">
                        <strong>æ¥å£:</strong> Tushare Pro API - limit_list_d (æ¶¨è·Œåœåˆ—è¡¨)
                    </div>
                    <div class="source-item">
                        <strong>æ•°æ®æ—¥æœŸ:</strong> <span id="dataDate">2025-09-09</span>
                        <small style="color: #059669; font-weight: normal;">ï¼ˆæœ€æ–°çœŸå®äº¤æ˜“æ—¥ï¼‰</small>
                    </div>
                    <div class="source-item">
                        <strong>æ›´æ–°æ—¶é—´:</strong> <span id="lastUpdate">--</span>
                    </div>
                    <div class="source-item">
                        <strong>Tokenç§¯åˆ†:</strong> 5000ç§¯åˆ† (å·²éªŒè¯)
                    </div>
                </div>
            </div>
            <div class="api-info">
                <h4>ğŸ”— è°ƒç”¨çš„çœŸå®æ¥å£</h4>
                <ul class="api-list">
                    <li>âœ“ pro.limit_list_d() - è·å–æ¶¨åœè‚¡ç¥¨è¯¦æƒ…</li>
                    <li>âœ“ pro.kpl_concept() - è·å–æ¦‚å¿µæ¿å—ç»Ÿè®¡</li>
                    <li>âœ“ pro.kpl_concept_cons() - è·å–æ¦‚å¿µæˆåˆ†è‚¡</li>
                </ul>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>